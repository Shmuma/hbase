<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;13.&nbsp;Performance Tuning</title><link rel="stylesheet" href="css/freebsd_docbook.css" type="text/css"><meta name="generator" content="DocBook XSL-NS Stylesheets V1.75.2"><link rel="home" href="book.html" title="The Apache HBase Book"><link rel="up" href="book.html" title="The Apache HBase Book"><link rel="prev" href="wal.html" title="12.4.&nbsp;Write Ahead Log (WAL)"><link rel="next" href="perf.configurations.html" title="13.2.&nbsp;Configurations"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter&nbsp;13.&nbsp;Performance Tuning</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="wal.html">Prev</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="perf.configurations.html">Next</a></td></tr></table><hr></div><div class="chapter" title="Chapter&nbsp;13.&nbsp;Performance Tuning"><div class="titlepage"><div><div><h2 class="title"><a name="performance"></a>Chapter&nbsp;13.&nbsp;Performance Tuning</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="performance.html#jvm">13.1. Java</a></span></dt><dd><dl><dt><span class="section"><a href="performance.html#gc">13.1.1. The Garbage Collector and HBase</a></span></dt></dl></dd><dt><span class="section"><a href="perf.configurations.html">13.2. Configurations</a></span></dt><dd><dl><dt><span class="section"><a href="perf.configurations.html#perf.number.of.regions">13.2.1. Number of Regions</a></span></dt><dt><span class="section"><a href="perf.configurations.html#perf.compactions.and.splits">13.2.2. Managing Compactions</a></span></dt><dt><span class="section"><a href="perf.configurations.html#perf.compression">13.2.3. Compression</a></span></dt><dt><span class="section"><a href="perf.configurations.html#perf.handlers">13.2.4. <code class="varname">hbase.regionserver.handler.count</code></a></span></dt><dt><span class="section"><a href="perf.configurations.html#perf.hfile.block.cache.size">13.2.5. <code class="varname">hfile.block.cache.size</code></a></span></dt><dt><span class="section"><a href="perf.configurations.html#perf.rs.memstore.upperlimit">13.2.6. <code class="varname">hbase.regionserver.global.memstore.upperLimit</code></a></span></dt><dt><span class="section"><a href="perf.configurations.html#perf.rs.memstore.lowerlimit">13.2.7. <code class="varname">hbase.regionserver.global.memstore.lowerLimit</code></a></span></dt><dt><span class="section"><a href="perf.configurations.html#perf.hstore.blockingstorefiles">13.2.8. <code class="varname">hbase.hstore.blockingStoreFiles</code></a></span></dt><dt><span class="section"><a href="perf.configurations.html#perf.hregion.memstore.block.multiplier">13.2.9. <code class="varname">hbase.hregion.memstore.block.multiplier</code></a></span></dt></dl></dd><dt><span class="section"><a href="perf.number.of.cfs.html">13.3. Number of Column Families</a></span></dt><dt><span class="section"><a href="perf.one.region.html">13.4. Data Clumping</a></span></dt><dt><span class="section"><a href="perf.batch.loading.html">13.5. Batch Loading</a></span></dt><dd><dl><dt><span class="section"><a href="perf.batch.loading.html#precreate.regions">13.5.1. 
  Table Creation: Pre-Creating Regions
  </a></span></dt></dl></dd><dt><span class="section"><a href="ch13s06.html">13.6. HBase Client</a></span></dt><dd><dl><dt><span class="section"><a href="ch13s06.html#perf.hbase.client.autoflush">13.6.1. AutoFlush</a></span></dt><dt><span class="section"><a href="ch13s06.html#perf.hbase.client.caching">13.6.2. Scan Caching</a></span></dt><dt><span class="section"><a href="ch13s06.html#perf.hbase.client.selection">13.6.3. Scan Attribute Selection</a></span></dt><dt><span class="section"><a href="ch13s06.html#perf.hbase.client.scannerclose">13.6.4. Close ResultScanners</a></span></dt><dt><span class="section"><a href="ch13s06.html#perf.hbase.client.blockcache">13.6.5. Block Cache</a></span></dt><dt><span class="section"><a href="ch13s06.html#perf.hbase.client.rowkeyonly">13.6.6. Optimal Loading of Row Keys</a></span></dt></dl></dd></dl></div><p>Start with the <a class="link" href="http://wiki.apache.org/hadoop/PerformanceTuning" target="_top">wiki
  Performance Tuning</a> page. It has a general discussion of the main
  factors involved; RAM, compression, JVM settings, etc. Afterward, come back
  here for more pointers.</p><div class="note" title="Enabling RPC-level logging" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a name="rpc.logging"></a>Enabling RPC-level logging</h3><p>Enabling the RPC-level logging on a RegionServer can often given
      insight on timings at the server.  Once enabled, the amount of log
      spewed is voluminous.  It is not recommended that you leave this
      logging on for more than short bursts of time.  To enable RPC-level
      logging, browse to the RegionServer UI and click on 
      <span class="emphasis"><em>Log Level</em></span>.  Set the log level to <code class="varname">DEBUG</code> for the package
      <code class="classname">org.apache.hadoop.ipc</code> (Thats right, for
      hadoop.ipc, NOT, hbase.ipc).  Then tail the RegionServers log.
      Analyze.</p><p>To disable, set the logging level back to <code class="varname">INFO</code> level.
  </p></div><div class="section" title="13.1.&nbsp;Java"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="jvm"></a>13.1.&nbsp;Java</h2></div></div></div><div class="section" title="13.1.1.&nbsp;The Garbage Collector and HBase"><div class="titlepage"><div><div><h3 class="title"><a name="gc"></a>13.1.1.&nbsp;The Garbage Collector and HBase</h3></div></div></div><div class="section" title="13.1.1.1.&nbsp;Long GC pauses"><div class="titlepage"><div><div><h4 class="title"><a name="gcpause"></a>13.1.1.1.&nbsp;Long GC pauses</h4></div></div></div><p>In his presentation, <a class="link" href="http://www.slideshare.net/cloudera/hbase-hug-presentation" target="_top">Avoiding
        Full GCs with MemStore-Local Allocation Buffers</a>, Todd Lipcon
        describes two cases of stop-the-world garbage collections common in
        HBase, especially during loading; CMS failure modes and old generation
        heap fragmentation brought. To address the first, start the CMS
        earlier than default by adding
        <code class="code">-XX:CMSInitiatingOccupancyFraction</code> and setting it down
        from defaults. Start at 60 or 70 percent (The lower you bring down the
        threshold, the more GCing is done, the more CPU used). To address the
        second fragmentation issue, Todd added an experimental facility that
        must be explicitly enabled in HBase 0.90.x (Its defaulted to be on in
        0.92.x HBase). See <code class="code">hbase.hregion.memstore.mslab.enabled</code>
        to true in your <code class="classname">Configuration</code>. See the cited
        slides for background and detail.</p></div></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="wal.html">Prev</a>&nbsp;</td><td width="20%" align="center">&nbsp;</td><td width="40%" align="right">&nbsp;<a accesskey="n" href="perf.configurations.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">12.4.&nbsp;Write Ahead Log (WAL)&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="book.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;13.2.&nbsp;Configurations</td></tr></table></div></body></html>